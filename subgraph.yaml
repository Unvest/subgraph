specVersion: 1.1.0
description: Unvest Protocol Subgraph
repository: https://github.com/Unvest/subgraph
schema:
  file: ./schema.graphql
dataSources:
  - kind: ethereum
    name: VestingTokenFactoryV2
    network: optimism
    source:
      abi: VestingTokenFactoryV2
      address: "0x07A1eB6f6339DAf50ce17230b866dc9B30806B88"
      startBlock: 75734781
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      entities:
        - Platform
        - UnderlyingToken
        - VestingToken
        - VestingTokenFactory
        - UserBalance
        - VestingBalance
      abis:
        - name: VestingTokenFactoryV2
          file: ./abis/VestingTokenFactoryV2.json
        - name: VestingTokenV2
          file: ./abis/VestingTokenV2.json
        - name: ERC20Metadata
          file: ./abis/ERC20Metadata.json
      eventHandlers:
        - event: OwnershipTransferred(indexed address,indexed address)
          handler: handleOwnershipTransferred
        - event: VestingTokenCreated(indexed address,address)
          handler: handleVestingTokenV2Created
        - event: FeeCollectorChange(indexed address)
          handler: handleFeeCollectorChange
        - event: FeePercentageChange(uint64)
          handler: handleFeePercentageChange
      file: ./src/vesting-token-factory-v2.ts
  - kind: ethereum
    name: VestingTokenFactoryV3
    network: optimism
    source:
      abi: VestingTokenFactoryV3
      address: "0x208D9FB018dE04B31D5495691BE51CB5205d5cD5"
      startBlock: 117096931
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      entities:
        - CustomClaimFeeChange
        - CustomClaimFeeToggle
        - CustomTransferFeeChange
        - CustomTransferFeeToggle
        - FeeCollectorChange
        - GlobalClaimFeeChange
        - GlobalTransferFeeChange
        - OwnershipTransferred
        - VestingTokenCreated
      abis:
        - name: VestingTokenFactoryV3
          file: ./abis/VestingTokenFactoryV3.json
      eventHandlers:
        - event: VestingTokenCreated(indexed address,address)
          handler: handleVestingTokenV3Created
        - event: CustomClaimFeeChange(indexed address,uint64)
          handler: handleCustomClaimFeeChange
        - event: CustomClaimFeeToggle(indexed address,bool)
          handler: handleCustomClaimFeeToggle
        - event: CustomTransferFeeChange(indexed address,uint64)
          handler: handleCustomTransferFeeChange
        - event: CustomTransferFeeToggle(indexed address,bool)
          handler: handleCustomTransferFeeToggle
        - event: FeeCollectorChange(indexed address)
          handler: handleFeeCollectorChange
        - event: GlobalClaimFeeChange(uint64)
          handler: handleGlobalClaimFeeChange
        - event: GlobalTransferFeeChange(uint64)
          handler: handleGlobalTransferFeeChange
        - event: OwnershipTransferred(indexed address,indexed address)
          handler: handleOwnershipTransferred
      file: ./src/vesting-token-factory-v3.ts
templates:
  - kind: ethereum/contract
    name: VestingTokenV2
    network: optimism
    source:
      abi: VestingTokenV2
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      entities:
        - Platform
        - UnderlyingToken
        - VestingToken
        - UserBalance
        - VestingBalance
        - Initialized
        - Claim
        - Transfer
      abis:
        - name: VestingTokenV2
          file: ./abis/VestingTokenV2.json
        - name: VestingTokenV3
          file: ./abis/VestingTokenV3.json
        - name: ERC20Metadata
          file: ./abis/ERC20Metadata.json
      eventHandlers:
        - event: Initialized(uint8)
          handler: handleInitialized
        - event: Claim(indexed address,uint256)
          handler: handleClaim
        - event: Transfer(indexed address,indexed address,uint256)
          handler: handleTransfer
      file: ./src/vesting-token.ts
  - kind: ethereum/contract
    name: VestingTokenV3
    network: optimism
    source:
      abi: VestingTokenV3
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      entities:
        - Platform
        - UnderlyingToken
        - VestingToken
        - UserBalance
        - VestingBalance
        - Initialized
        - Claim
        - Transfer
      abis:
        - name: VestingTokenV3
          file: ./abis/VestingTokenV3.json
        - name: ERC20Metadata
          file: ./abis/ERC20Metadata.json
      eventHandlers:
        - event: Initialized(uint64)
          handler: handleInitialized
        - event: Claim(indexed address,uint256)
          handler: handleClaim
        - event: Transfer(indexed address,indexed address,uint256)
          handler: handleTransfer
      file: ./src/vesting-token.ts
